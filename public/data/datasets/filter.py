import pandas as pd
import os

whitelist = [360, 458, 196, 356, 156, 376, 275, 422, 760, 410, 704, 408, 64, 512, 860, 398, 762, 496, 784, 116, 268, 31, 634, 682, 792, 418, 417, 51, 368, 364, 586, 764, 414, 626, 96, 104, 50, 4, 795, 400, 524, 887, 344, -99, -99, 608, 144, -99, 392, -99, 702, 48, 446, 152, 68, 604, 32, 740, 328, 76, 858, 218, 862, 170, 600, 238, 188, 558, 663, 534, 332, 214, 222, 320, 192, 340, 840, 304, 531, 124, 484, 84, 591, 533, 44, 796, 666, 780, 308, 670, 52, 662, 212, 500, 28, 659, 850, 652, 630, 660, 92, 388, 136, 60, 554, 540, 598, 36, 242, 612, 258, 296, 584, 574, 184, 776, 520,
    876, 882, 90, 798, 583, 548, 570, 16, 585, 250, 316, 804, 580, -99, 112, 276, 440, 643, 203, 233, 428, -99, 752, 246, 442, 56, 807, 8, -99, 724, 208, 616, 642, 348, 372, 703, 826, 300, 40, 705, 380, 756, 528, 438, 688, 191, 100, 492, 20, 499, 70, 620, 498, 336, 352, 470, 231, 832, 831, 833, 728, 248, 234, 706, 404, 674, 454, 834, -99, 504, 732, 178, 180, 516, 710, 434, 788, 894, 694, 324, 430, 232, 140, 729, 262, 384, 466, 686, 566, 204, 12, 24, 72, 716, 508, 148, 748, 108, 646, 854, 800, 426, 120, 266, 562, 288, 768, 624, 818, 478, 226, 678, 270, 450, 174, 132]

dirs = ["./ecology/", "./economy/", "./population/"]
files = [os.listdir(path) for path in dirs]
for i in range(len(dirs)):
   files[i] = [f"{dirs[i]}{file}" for file in files[i]]
files = [item for list in files for item in list]

for file in files:
    df = pd.read_csv(file)
    df = df[df["Id"].isin(whitelist)]
    df = df.dropna(axis=1, thresh=len(df) * .7)
    df.to_csv(file)